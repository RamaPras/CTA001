<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2"/>
    </startup>
  <appSettings>
    <add key="PROGRAM_NAME" value="CTA001H2"/>
    <add key="CONN_STR" value="Data Source=192.168.27.229;User ID=PRD_MSI_AL01;Password=PRD_MSI_AL01123;"/>
    <add key="QUERY" value="

         SELECT
CASE WHEN SUBSTR(ACCT_TYPE,1,1) = 9 THEN  4 ELSE 1 END IDX,
A.CABANG,	
B.BRANCH_NAME,
CAST(CAST(A.TANGGAL AS DATE FORMAT 'DD/MM/YYYY') AS VARCHAR(10)) TANGGAL,	
TRIM(TRIM(TO_CHAR( A.ACCOUNT_TYPE,'0000')) || '  '  || TRIM(TO_CHAR(A.SUB_CATEGORY,'0000'))) AS ACCT_TYPE,
SUBSTR('0000', 1, 4-LENGTH(CAST(A.ACCOUNT_TYPE AS VARCHAR(4)))) || CAST(A.ACCOUNT_TYPE AS VARCHAR(4)) ACCOUNT_TYPE,
SUBSTR('0000', 1, 4-LENGTH(CAST(A.SUB_CATEGORY AS VARCHAR(4)))) || CAST(A.SUB_CATEGORY AS VARCHAR(4)) SUB_CATEGORY,
A.PRD_NAME_CTA,
C.CONT,
CAST(A.CIF_KEY AS VARCHAR(10)),
'0000000'||CAST(A.NO_REKENING AS VARCHAR(9)) NO_REKENING,
SUBSTR(A.NAMA_NASABAH, 0 , 21) AS NAMA_NASABAH,
A.GL_ACCOUNT_ID,
F.GL_OUTSTANDING,
A.BI_CCY,
E.REKAP_OUTSTANDING,
A.SEGMEN,
A.PLAFON,
A.OUTSTANDING,
D.SUM_PLAFON,
D.SUM_OUTSTANDING,
CAST(CAST(A.TGL_BUKA AS DATE FORMAT 'DD/MM/YYYY') AS VARCHAR(10)),
CAST(CAST(A.TGL_TUTUP AS DATE FORMAT 'DD/MM/YYYY') AS VARCHAR(10)),
CAST(CAST(A.TGL_KLAIM AS DATE FORMAT 'DD/MM/YYYY') AS VARCHAR(10)),
A.TIPE,
CAST(CAST(CURRENT_DATE AS DATE FORMAT 'DD/MM/YYYY') AS VARCHAR(10)) SYSDATE


from PRD_BNI_RPT.P_OP_CTA001H2 A
LEFT JOIN PRD_BNI_SRI.LOOKUP_BRANCH B 
ON A.CABANG = B.BRANCH_CODE
LEFT JOIN (SELECT 
			CABANG,ACCOUNT_TYPE,SUB_CATEGORY,BI_CCY,
			COUNT(PRD_NAME_CTA) AS  CONT
			FROM PRD_BNI_RPT.P_OP_CTA001H2 
			GROUP BY CABANG,ACCOUNT_TYPE,SUB_CATEGORY,BI_CCY
			WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') ) C
			ON  A.CABANG = C.CABANG AND A.ACCOUNT_TYPE = C.ACCOUNT_TYPE AND  A.SUB_CATEGORY = C.SUB_CATEGORY AND A.BI_CCY = C.BI_CCY
LEFT JOIN (SELECT 
			CABANG,ACCOUNT_TYPE,SUB_CATEGORY,BI_CCY,
			SUM(PLAFON) AS  SUM_PLAFON,
			SUM(OUTSTANDING) AS SUM_OUTSTANDING
			FROM PRD_BNI_RPT.P_OP_CTA001H2 
			GROUP BY CABANG,ACCOUNT_TYPE,SUB_CATEGORY,BI_CCY
			WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') ) D
			ON  A.CABANG = D.CABANG AND A.ACCOUNT_TYPE = D.ACCOUNT_TYPE AND  A.SUB_CATEGORY = D.SUB_CATEGORY AND A.BI_CCY = D.BI_CCY
LEFT JOIN (SELECT 
			CABANG,BI_CCY,
			SUM(OUTSTANDING) AS REKAP_OUTSTANDING
			FROM PRD_BNI_RPT.P_OP_CTA001H2 
			GROUP BY CABANG,BI_CCY
			WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') ) E
			ON  A.CABANG = E.CABANG  AND A.BI_CCY = E.BI_CCY
LEFT JOIN (SELECT 
			CABANG,GL_ACCOUNT_ID,
			SUM(OUTSTANDING) AS GL_OUTSTANDING
			FROM PRD_BNI_RPT.P_OP_CTA001H2 
			GROUP BY CABANG,GL_ACCOUNT_ID
			WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') ) F
			ON  A.CABANG = F.CABANG  AND A.GL_ACCOUNT_ID = F.GL_ACCOUNT_ID



WHERE A.TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') AND A.CABANG BETWEEN 0 AND 800
ORDER BY B.BRANCH_NAME, A.ACCOUNT_TYPE, A.SUB_CATEGORY,A.NO_REKENING"/>

   <add key="QUERY2" value="select 
A.CABANG,
B.BRANCH_NAME,
A.GL_ACCOUNT_ID,
sum(A.OUTSTANDING) as GL_OUTSTANDING

from PRD_BNI_RPT.P_OP_CTA001H2 A
LEFT JOIN PRD_BNI_SRI.LOOKUP_BRANCH B 
ON A.CABANG = B.BRANCH_CODE

WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') AND A.CABANG BETWEEN 0 AND 800
group by A.CABANG,
B.BRANCH_NAME,
A.GL_ACCOUNT_ID
ORDER BY B.BRANCH_NAME, A.GL_ACCOUNT_ID"/>
    
<add key="QUERY3" value="select 
A.CABANG,
B.BRANCH_NAME,
A.BI_CCY,
sum(A.OUTSTANDING) as REKAP_OUTSTANDING,
COUNT(A.BI_CCY) AS CONT

from PRD_BNI_RPT.P_OP_CTA001H2 A
LEFT JOIN PRD_BNI_SRI.LOOKUP_BRANCH B 
ON A.CABANG = B.BRANCH_CODE

WHERE TANGGAL = CAST('20200207' AS DATE FORMAT 'YYYYMMDD') AND A.CABANG BETWEEN 0 AND 800
group by A.CABANG,
B.BRANCH_NAME,
A.BI_CCY
ORDER BY B.BRANCH_NAME, A.BI_CCY"/>
    
    <add key="PRINT_QUERY" value="N"/>
    <add key="TIMEOUT" value="6000"/>
    <add key="FILENAME" value="CTA001h2_1.txt"/>
    <add key="DIRECTORY" value="C:\ReportNet\Mulai\"/>
    <add key="RUN_FTP" value="N"/>
    <add key="FTP_ZIP" value="N"/>
    <add key="FTP" value="ftp://172.18.40.65/INSTALLER_IDE/"/>
    <add key="USERNAME" value="SHARE_FTP"/>
    <add key="PASSWORD" value="SHARE_FTP"/>
    <add key="READ_KEY" value="Y"/>
    <add key="ClientSettingsProvider.ServiceUri" value=""/>
  </appSettings> 
</configuration>
